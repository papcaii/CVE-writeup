# CVE-2023-21768

CVE-2023-21768 target đến afd.sys - một driver handle các network connection, như socket...
![Uploading image.png…]()

## Reverse

Trước hết ta sẽ dùng một kĩ thuật là binary diff giữa bản patched và bản chưa patched để xác định và giới hạn các hàm được fix
<img src="https://i.imgur.com/QMgSJJf.png">

Rất may là chỉ có 1 hàm được thay đổi, đó chính là hàm `afd!AfdNotifyRemoveIoCompletion`
<img src="https://i.imgur.com/YxhV4ZW.png">
Như đã thấy thì ở bản patch hàm ProbeForWrite đã được thêm vào ở case khi `PreviousMode != 0` (Nếu `PreviousMode = 0` nghĩa là chương trình đang chạy ở Kernel mode, ngược lại thì đang ở User mode)
Hàm này sẽ kiểm tra xem liệu địa chi
## Usage

```python
import foobar

# returns 'words'
foobar.pluralize('word')

# returns 'geese'
foobar.pluralize('goose')

# returns 'phenomenon'
foobar.singularize('phenomena')
```

## Contributing

Pull requests are welcome. For major changes, please open an issue first
to discuss what you would like to change.

Please make sure to update tests as appropriate.

## License

[MIT](https://choosealicense.com/licenses/mit/)
